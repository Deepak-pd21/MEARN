<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>UserList+API+XHR</title>
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.7/dist/css/bootstrap.min.css"
      rel="stylesheet"
      integrity="sha384-LN+7fdVzj6u52u30Kp6M/trliBMCMKTyK833zpbD+pXdCLuTusPj697FH4R/5mcr"
      crossorigin="anonymous"
    />
  </head>
  <body>
    <div class="container p-3 rounded mt-5 bg-primary">
      <h1 class="text-white text-center">User List</h1>
      <table class="mt-4 shadow table">
        <thead>
          <tr>
          <th>#</th>
          <th>Name</th>
          <th>Email</th>
          <th>Address</th>
          <th>Website</th>
          <th>Phone</th>
          <th>Comapany</th>
          </tr>
        </thead>
        <tbody id="result">
          <tr>
            <td>#</td>
          <td>Name</td>
          <td>Email</td>
          <td>Address</td>
          <td>Website</td>
          <td>Phone</td>
          <td>Comapany</td>
          </tr>
        </tbody>
      </table>
    </div>
  </body>
  <script>
    // to get data from https://jsonplaceholder.typicode.com/users
    // steps to call api usinf XHR
    // 1. Create object for XMLHttpRequest class
    const api = new XMLHttpRequest();
    // 2.Create / initialize request for https://jsonplaceholder.typicode.com/users
    api.open("GET", "https://jsonplaceholder.typicode.com/users")
    // 3. send request
    api.send()
    api.onreadystatechange = () => {
      console.log(api.readyState);
      if (api.readyState == 4){
        if (api.status >= 200 && api.status < 300) {
          
          const users = JSON.parse(api.responseText);
          console.log(users);
          users.forEach((user, index) => {
            result.innerHTML += `
        <tr>
            <td>${index+1}</td>
            <td>${user.name}</td>
            <td>${user.email}</td>
            <td>${user.address.street},${user.address.city}</td>
            <td>${user.website}</td>
            <td>${user.phone}</td>
            <td>${user.company.name}</td>
        </tr>`
          })
        } else {
          console.log("Api call Failed");
        }
      } else {
        console.log("Waiting for server response...");
      }
    }
  </script>
</html>